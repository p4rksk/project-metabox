{{> layout/header}}
<head>
    <link rel="stylesheet" href="/css/mypageHome.css">
</head>


<div class="container">
    <div class="profile-card">
        <div class="header">
            <img src="{{model.userDTO.imgFilename}}">
            <div class="info">
                <h3>{{model.userDTO.name}}ë‹˜</h3>
                <p><strong>{{model.userDTO.nickname}}</strong></p>
                <p>ê³ ê°ë‹˜ì€ <span class="text-danger">ì¼ë°˜</span> ì…ë‹ˆë‹¤.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 points">
                <h4>POINT <i class="fas fa-question-circle" data-toggle="tooltip"
                             title="1,000P ì´ìƒë¶€í„° 10P ë‹¨ìœ„ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."></i></h4>
                <p>ì‚¬ìš©ê°€ëŠ¥ í¬ì¸íŠ¸ <strong>{{model.userDTO.point}} ì </strong></p>
            </div>
            <div class="col-md-6 vip-points">
                <h4>VIP ì ìˆ˜ <i class="fas fa-question-circle" data-toggle="tooltip"
                              title="1ë§Œì  ëˆ„ì  ë‹¬ì„±í•˜ì‹œë©´ ë‹¤ìŒë‹¬ VIPë¡œ ìŠ¹ê¸‰ë©ë‹ˆë‹¤."></i></h4>
                <p>VIP ëˆ„ì  ì ìˆ˜ <strong>{{model.userDTO.point}}/10,000ì </strong></p>
            </div>
        </div>


        <div class="grid">
            <div>1</div>
            <div>2</div>
            <div>3</div>
            <div>4</div>
            <div>5</div>
            <div class="setting" style="text-align: center; font-weight: bold" onclick="openModal()">ë¹ ë¥¸ ê·¹ì¥ ì„ íƒ</div>
        </div>
    </div>

    <!-- ë°‘ì˜ ë¶€ë¶„ -->
    <div class="row mt-5 justify-content-between">
        {{> layout/sidebar}}
        <div class="col-md-9 content-section">
            <div class="row row-style">
                <div class="col-md-4">
                    <a href="/mypage/detail-saw" style="text-decoration: none; color: inherit;">
                        ğŸˆ
                        <h6>ê¸°ëŒ€ë˜ëŠ” ì˜í™”</h6>
                        <p>ë³´ê³  ì‹¶ì€ ì˜í™”ë¥¼<br>ë¯¸ë¦¬ ë‹´ì•„ë‘ê³  ì‹¶ë‹¤ë©´?</p>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="/mypage/detail-saw" style="text-decoration: none; color: inherit;">
                        ğŸ’–
                        <h6>ë‚´ê°€ ë³¸ ì˜í™”</h6>
                        <p>ê´€ëŒí•œ ì˜í™”ë¥¼<br>í•œ ë²ˆì— ëª¨ì•„ ë³´ê³  ì‹¶ë‹¤ë©´?</p>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="/mypage/detail-saw" style="text-decoration: none; color: inherit;">
                        â­
                        <h6>ë‚´ê°€ ì“´ í‰ì </h6>
                        <p>ê´€ëŒ í›„ ë‚´ ëŠë‚Œì„<br>ì ìˆ˜ë¡œ ë‚¨ê¸°ê³  ì‹¶ë‹¤ë©´?</p>
                    </a>
                </div>
            </div>

            <br>

            <div class="mt-4">
                <h5>MY ì˜ˆë§¤ë‚´ì—­ 0ê±´ <span class="add-button">+</span></h5>

                <div class="mt-4 boxed">
                    {{#model.ticketingDTO}}
                        <div class="row">
                            <div class="col-md-3">
                                <img src="/image/movie/{{imgFilename}}" class="img-fluid"
                                     style="width: 100px; height: 150px">
                                <p class="card-text">ì˜ˆë§¤ë²ˆí˜¸ ì´ê±° ë§ì¶°ì•¼í•©ë‹ˆë‹¤~</p>
                            </div>
                            <div class="col-md-9" style="padding-top: 5%">
                                <h5 class="card-title"><strong>{{title}}</strong></h5>
                                <p class="card-text">ê´€ëŒê·¹ì¥ {{theaterName}} ({{name}})</p>
                                <p class="card-text">ê´€ëŒì¼ì‹œ {{date}}</p>
                                <p class="card-text">ìƒì˜ì‹œê°„ {{startTime}} ({{startTime}} ~ {{endTime}})</p>
                            </div>
                        </div>
                    {{/model.ticketingDTO}}

                    {{^model.ticketingDTO}}
                        <p>ê³ ê°ë‹˜ì˜ ìµœê·¼ ì˜ˆë§¤ë‚´ì—­ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                    {{/model.ticketingDTO}}
                </div>

            </div>
            <div class="mt-4">
                <h5>MY Q&A 0ê±´ <span class="add-button">+</span></h5>
                <div class="mt-4 boxed">
                    <p>ê³ ê°ë‹˜ì˜ 1:1 ë¬¸ì˜ë‚´ì—­ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ëª¨ë‹¬ì°½ html ë””ìì¸ -->
<div id="myModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="tab">
            <div style="background-color: #4E0929; color: white">ìì£¼ê°€ëŠ” META BOX</div>
        </div>
        <div class="tab-content active" id="tab1">
            <div class="theater-list theater-area-list">
                {{#model.theaterDTOS}}
                    <div class="tab-button" data-theater-id="{{id}}" data-area="{{areaName}}">{{areaName}}</div>
                {{/model.theaterDTOS}}
            </div>
        </div>
        {{#model.theaterDTOS}}
            <div class="tab-content area-name-list" id="area-name-list-{{id}}">
                {{#theaterNameDTOS}}
                    <div class="theater-list theater-list-name">
                        <div data-theater="{{theaterName}}">{{theaterName}}</div>
                    </div>
                {{/theaterNameDTOS}}
            </div>
        {{/model.theaterDTOS}}

        <div class="selected-theater">
            <!-- ì„ íƒí•œ ê·¹ì¥ì´ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>

    </div>
</div>

<script>

    //íˆ´íŒ
    $('[data-toggle="tooltip"]').tooltip();

    // ëª¨ë‹¬ì°½ script
    function openModal() {
        $("#myModal").css("display", "block");
    }

    function closeModal() {
        $("#myModal").css("display", "none");
    }

    // area ê±°ëŠ” ê²ƒ
    $('.theater-area-list').on('click', '.tab-button', function () {
        // alert("ì°í˜ ")
       let id = $(this).data('theater-id');
       // console.log("id " + id)
       $('.area-name-list').removeClass('active');
        // í´ë¦­í•œ ë²„íŠ¼ê³¼ ì¼ì¹˜í•˜ëŠ” ì˜ì—­ í‘œì‹œ
        $('#area-name-list-' + id).addClass('active');

    });

    // ëª¨ë‹¬ì°½ ë‹«ê¸°
    $(window).on('click', function (event) {
        if (event.target == $("#myModal")[0]) {
            closeModal();
        }
    });

    // ìµœëŒ€ 5ê°œ. ì¤‘ë³µì²´í¬ë„ í•„ìš”í•¨
    const maxSelectedTheaters = 5;

    // MEATABOX ê°•ë‚¨ ê±°ëŠ” ê²ƒ
    $('.theater-list-name div').on('click', function () {

        // alert("ì•Œë¦¼");

        // ì¤‘ë³µì²´í¬ ìš© ê°’
        const theaterName = $(this).data('theater');
        console.log("ë„¤ì„ " + theaterName)

        // ì¤‘ë³µì œê±°
        let isSelected = false;
        $('.selected-theater div').each(function () {
            if ($(this).text().trim() === theaterName) {
                isSelected = true;
                return false;
            }
        });

        if (isSelected) {
            alert('ì´ë¯¸ ì„ íƒí•œ ê·¹ì¥ì…ë‹ˆë‹¤.');
            return;
        }


        if ($('.selected-theater div').length >= maxSelectedTheaters) {
            alert('ìµœëŒ€ 5ê°œì˜ ê·¹ì¥ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            return;
        }

        // ê·¹ì¥ ì¶”ê°€
        // console.log("ë„¤ì„ì•„ " + theaterName);
        const selectedTheater = $(`
            <div>
                ${theaterName}
                <button class="delete-button">&times;</button>
            </div>
        `);

        selectedTheater.find('.delete-button').on('click', function () {
            $(this).parent().remove();
        });

        $('.selected-theater').append(selectedTheater);
    });


    // $(".selected-theater").each(function () {
    //     alert("dd");
    //     let id = $('.theater-area-list').data('theater-id');
    //     console.log("idid = " + id);
    //
    //     const theaterName = $('.theater-list-name div').data('theater');
    //
    //     console.log("then = " + theaterName);
    //     if (theaterName === id) {
    //         isOptionSelected = true;
    //         return false;
    //     }
    // });


</script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js"></script>
{{> layout/footer}}
